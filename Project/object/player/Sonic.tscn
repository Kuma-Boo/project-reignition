[gd_scene load_steps=68 format=3 uid="uid://dm3o3mmgewihr"]

[ext_resource type="Resource" uid="uid://bijq2wxw8v0nx" path="res://object/player/resource/movement settings/ground/BackstepSettings.tres" id="2"]
[ext_resource type="Resource" uid="uid://2r18q1m50o37" path="res://object/player/resource/movement settings/ground/GroundSettings.tres" id="2_qbh54"]
[ext_resource type="Resource" uid="uid://bsdyr3nwbjt2s" path="res://object/player/resource/movement settings/aerial/AirSettings.tres" id="3_ywh7m"]
[ext_resource type="Script" path="res://object/player/resource/script/CharacterPathFollower.cs" id="6_80hf8"]
[ext_resource type="PackedScene" uid="uid://dlnfilv6x7rkh" path="res://interface/gameplay/hud/lockon/Lockon.tscn" id="7"]
[ext_resource type="Resource" path="res://object/player/resource/movement settings/ground/SidleSettings.tres" id="8"]
[ext_resource type="Script" path="res://object/player/resource/script/CharacterController.cs" id="10"]
[ext_resource type="Script" path="res://object/player/resource/script/CharacterAnimator.cs" id="11"]
[ext_resource type="PackedScene" uid="uid://cwas4ba3y3woi" path="res://object/player/resource/model/Model.tscn" id="12"]
[ext_resource type="PackedScene" uid="uid://qf6je82vhwme" path="res://object/player/resource/component/Skills.tscn" id="13"]
[ext_resource type="Script" path="res://object/player/resource/script/CharacterSound.cs" id="15"]
[ext_resource type="AudioStream" uid="uid://xpupnecr1hc6" path="res://sound/sfx/player/en/VOICE_E_2.wav" id="16"]
[ext_resource type="AudioStream" uid="uid://cskbn8mwowjpr" path="res://sound/sfx/player/en/VOICE_E_24.wav" id="17"]
[ext_resource type="AudioStream" uid="uid://bddbm1etyfgdm" path="res://sound/sfx/player/ja/VOICE_J_24.wav" id="18"]
[ext_resource type="AudioStream" uid="uid://bcsslx745eoka" path="res://sound/sfx/player/ja/VOICE_J_2.wav" id="19"]
[ext_resource type="AudioStream" uid="uid://nk8g3qa67l4" path="res://sound/sfx/player/PLAYER_5.wav" id="20"]
[ext_resource type="AudioStream" uid="uid://cqcdwe2b7phjl" path="res://sound/sfx/player/PLAYER_75.wav" id="21"]

[sub_resource type="Curve" id="Curve_0y4at"]
_data = [Vector2(0, 0), 0.0, 0.0, 0, 0, Vector2(0.2, 0), 0.0, 0.0, 0, 0, Vector2(0.5, 1), 0.0777784, 0.0, 0, 0, Vector2(1, 1), 0.0, 0.0, 0, 0]
point_count = 4

[sub_resource type="SphereMesh" id="SphereMesh_wrj8s"]

[sub_resource type="SphereShape3D" id="SphereShape3D_uookt"]

[sub_resource type="SphereShape3D" id="80"]
radius = 0.4

[sub_resource type="AnimationNodeTransition" id="70"]
enabled_inputs = 1
xfade_time = 0.16
input_0/name = "Normal"
input_0/auto_advance = false

[sub_resource type="AnimationNodeTransition" id="55"]
enabled_inputs = 2
input_0/name = "Grounded"
input_0/auto_advance = false
input_1/name = "Airborne"
input_1/auto_advance = false

[sub_resource type="AnimationNodeTransition" id="130"]
enabled_inputs = 4
input_0/name = "Countdown"
input_0/auto_advance = false
input_1/name = "state 1"
input_1/auto_advance = false
input_2/name = "state 2"
input_2/auto_advance = false
input_3/name = "state 3"
input_3/auto_advance = false

[sub_resource type="AnimationNodeAnimation" id="131"]
animation = &"RESET"

[sub_resource type="AnimationNodeBlendTree" id="132"]
graph_offset = Vector2(-605.591, 142.631)
nodes/Animation/node = SubResource("130")
nodes/Animation/position = Vector2(32, 144)
nodes/countdown/node = SubResource("131")
nodes/countdown/position = Vector2(-320, 160)
node_connections = [&"output", 0, &"Animation", &"Animation", 0, &"countdown"]

[sub_resource type="AnimationNodeTransition" id="111"]
xfade_time = 0.1

[sub_resource type="AnimationNodeTransition" id="103"]
xfade_time = 0.05

[sub_resource type="AnimationNodeOneShot" id="125"]

[sub_resource type="AnimationNodeAnimation" id="126"]
animation = &"backflip"

[sub_resource type="AnimationNodeAnimation" id="102"]
animation = &"fall-loop"

[sub_resource type="AnimationNodeAnimation" id="105"]
animation = &"fall-start"

[sub_resource type="AnimationNodeOneShot" id="104"]
fadeout_time = 0.02

[sub_resource type="AnimationNodeTimeSeek" id="123"]

[sub_resource type="AnimationNodeAnimation" id="107"]
animation = &"jump-loop"

[sub_resource type="AnimationNodeAnimation" id="108"]
animation = &"jump-start"

[sub_resource type="AnimationNodeOneShot" id="106"]

[sub_resource type="AnimationNodeTimeScale" id="122"]

[sub_resource type="AnimationNodeAnimation" id="120"]
animation = &"jump-accel-loop"

[sub_resource type="AnimationNodeAnimation" id="121"]
animation = &"jump-dash-loop"

[sub_resource type="AnimationNodeStateMachine" id="112"]
states/jump-accel-loop/node = SubResource("120")
states/jump-accel-loop/position = Vector2(257.464, 91.48)
states/jump-dash-loop/node = SubResource("121")
states/jump-dash-loop/position = Vector2(609.4, 91.8)

[sub_resource type="AnimationNodeBlendTree" id="109"]
graph_offset = Vector2(-723.072, 36.1916)
nodes/IsJumpDashing/node = SubResource("111")
nodes/IsJumpDashing/position = Vector2(-16, 144)
nodes/IsJumping/node = SubResource("103")
nodes/IsJumping/position = Vector2(-912, 32)
nodes/backflip/node = SubResource("125")
nodes/backflip/position = Vector2(-672, 112)
nodes/backflip_anim/node = SubResource("126")
nodes/backflip_anim/position = Vector2(-912, 256)
nodes/fall/node = SubResource("104")
nodes/fall/position = Vector2(-1360, -32)
nodes/fall-loop/node = SubResource("102")
nodes/fall-loop/position = Vector2(-1584, -16)
nodes/fall-start/node = SubResource("105")
nodes/fall-start/position = Vector2(-1984, 192)
nodes/fall_reset/node = SubResource("123")
nodes/fall_reset/position = Vector2(-1520, 112)
nodes/jump/node = SubResource("106")
nodes/jump/position = Vector2(-368, 160)
nodes/jump-loop/node = SubResource("107")
nodes/jump-loop/position = Vector2(-1200, 176)
nodes/jump-start/node = SubResource("108")
nodes/jump-start/position = Vector2(-592, 336)
nodes/jump_cancel_time/node = SubResource("122")
nodes/jump_cancel_time/position = Vector2(-1808, 160)
nodes/jump_dash_state/node = SubResource("112")
nodes/jump_dash_state/position = Vector2(-368, 400)
node_connections = [&"output", 0, &"IsJumpDashing", &"backflip", 0, &"IsJumping", &"backflip", 1, &"backflip_anim", &"fall", 0, &"fall-loop", &"fall", 1, &"fall_reset", &"fall_reset", 0, &"jump_cancel_time", &"jump", 0, &"backflip", &"jump", 1, &"jump-start", &"jump_cancel_time", 0, &"fall-start"]

[sub_resource type="AnimationNodeOneShot" id="65"]
fadeout_time = 0.15

[sub_resource type="AnimationNodeAnimation" id="72"]
animation = &"idle"

[sub_resource type="AnimationNodeTransition" id="114"]
enabled_inputs = 2
xfade_time = 0.1
input_0/name = "Standing"
input_0/auto_advance = false
input_1/name = "Crouching"
input_1/auto_advance = false

[sub_resource type="AnimationNodeAnimation" id="133"]
animation = &"walk"

[sub_resource type="AnimationNodeAnimation" id="134"]
animation = &"jog"

[sub_resource type="AnimationNodeBlendSpace1D" id="135"]
blend_point_0/node = SubResource("133")
blend_point_0/pos = 0.2
blend_point_1/node = SubResource("134")
blend_point_1/pos = 0.5
min_space = 0.0
sync = true

[sub_resource type="AnimationNodeTimeScale" id="79"]

[sub_resource type="AnimationNodeTransition" id="78"]
sync = true
enabled_inputs = 4
xfade_time = 0.2
input_0/name = "Backstep"
input_0/auto_advance = false
input_1/name = "Idle"
input_1/auto_advance = false
input_2/name = "Jogging"
input_2/auto_advance = false
input_3/name = "Running"
input_3/auto_advance = false

[sub_resource type="AnimationNodeAnimation" id="85"]
animation = &"run"

[sub_resource type="AnimationNodeAnimation" id="86"]
animation = &"RESET"

[sub_resource type="AnimationNodeAnimation" id="87"]
animation = &"RESET"

[sub_resource type="AnimationNodeBlendSpace1D" id="84"]
blend_point_0/node = SubResource("85")
blend_point_0/pos = 0.0
blend_point_1/node = SubResource("86")
blend_point_1/pos = -1.0
blend_point_2/node = SubResource("87")
blend_point_2/pos = 1.0

[sub_resource type="AnimationNodeAnimation" id="124"]
animation = &"backstep"

[sub_resource type="AnimationNodeAnimation" id="115"]
animation = &"crouch-loop"

[sub_resource type="AnimationNodeAnimation" id="116"]
animation = &"crouch-start"

[sub_resource type="AnimationNodeStateMachineTransition" id="117"]
switch_mode = 2
auto_advance = true

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_0xp1n"]

[sub_resource type="AnimationNodeStateMachine" id="118"]
states/End/position = Vector2(764, 100.318)
states/crouch-loop/node = SubResource("115")
states/crouch-loop/position = Vector2(580.6, 99.992)
states/crouch-start/node = SubResource("116")
states/crouch-start/position = Vector2(357.4, 100.998)
transitions = ["crouch-start", "crouch-loop", SubResource("117"), "Start", "crouch-start", SubResource("AnimationNodeStateMachineTransition_0xp1n")]
graph_offset = Vector2(95, -24)

[sub_resource type="AnimationNodeBlendTree" id="71"]
graph_offset = Vector2(-675.925, 141.778)
nodes/Idle/node = SubResource("72")
nodes/Idle/position = Vector2(-1008, 240)
nodes/IsCrouching/node = SubResource("114")
nodes/IsCrouching/position = Vector2(100, 160)
nodes/Jog/node = SubResource("135")
nodes/Jog/position = Vector2(-752, 384)
nodes/MoveSpeed/node = SubResource("79")
nodes/MoveSpeed/position = Vector2(-288, 192)
nodes/MoveState/node = SubResource("78")
nodes/MoveState/position = Vector2(-512, 304)
nodes/Run/node = SubResource("84")
nodes/Run/position = Vector2(-752, 592)
nodes/backstep/node = SubResource("124")
nodes/backstep/position = Vector2(-752, 128)
nodes/crouch_state/node = SubResource("118")
nodes/crouch_state/position = Vector2(-144, 336)
node_connections = [&"output", 0, &"IsCrouching", &"IsCrouching", 0, &"MoveSpeed", &"IsCrouching", 1, &"crouch_state", &"MoveSpeed", 0, &"MoveState", &"MoveState", 0, &"backstep", &"MoveState", 1, &"Idle", &"MoveState", 2, &"Jog", &"MoveState", 3, &"Run"]

[sub_resource type="AnimationNodeBlendTree" id="37"]
graph_offset = Vector2(-390.048, -35.0758)
nodes/ActionState/node = SubResource("70")
nodes/ActionState/position = Vector2(-464, 176)
nodes/IsGrounded/node = SubResource("55")
nodes/IsGrounded/position = Vector2(-960, 192)
nodes/OneShotAnimations/node = SubResource("132")
nodes/OneShotAnimations/position = Vector2(-160, 272)
nodes/air_state/node = SubResource("109")
nodes/air_state/position = Vector2(-1280, 288)
nodes/countdown/node = SubResource("65")
nodes/countdown/position = Vector2(112, 160)
nodes/ground_state/node = SubResource("71")
nodes/ground_state/position = Vector2(-1280, 160)
node_connections = [&"output", 0, &"countdown", &"ActionState", 0, &"IsGrounded", &"IsGrounded", 0, &"ground_state", &"IsGrounded", 1, &"air_state", &"countdown", 0, &"ActionState", &"countdown", 1, &"OneShotAnimations"]

[sub_resource type="AnimationNodeStateMachinePlayback" id="113"]

[sub_resource type="AnimationNodeStateMachinePlayback" id="119"]

[sub_resource type="Animation" id="Animation_dbqye"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Components/Model:visible")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [true]
}

[sub_resource type="Animation" id="Animation_v1whi"]
resource_name = "invincibility"
length = 3.0
step = 0.0333333
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Components/Model:visible")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.133333, 0.266666, 0.4, 0.533333, 0.666666, 0.799999, 0.933332, 1.06667, 1.2, 1.33333, 1.46667, 1.6, 1.73333, 1.86666, 2, 2.13333, 2.26666, 2.4, 2.53333, 2.66666, 2.8, 2.9, 3),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [false, true, false, true, false, true, false, true, false, true, false, true, false, true, false, true, false, true, false, true, false, true, false, true]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_3ughb"]
_data = {
"RESET": SubResource("Animation_dbqye"),
"invincibility": SubResource("Animation_v1whi")
}

[node name="Player" type="CharacterBody3D" node_paths=PackedStringArray("environmentCollider", "PathFollower", "Animator", "Sound", "Skills", "Lockon") groups=["player"]]
collision_layer = 2
floor_stop_on_slope = false
script = ExtResource("10")
groundSettings = ExtResource("2_qbh54")
airSettings = ExtResource("3_ywh7m")
backstepSettings = ExtResource("2")
turningSpeedCurve = SubResource("Curve_0y4at")
landingBoost = 32.0
jumpHeight = 4.6
jumpDashSpeed = 36.0
jumpDashPower = 4.0
jumpDashGravity = 18.0
jumpDashMaxGravity = -24.0
backflipSpeed = 20.0
backflipHeight = 1.4
sidleSettings = ExtResource("8")
environmentCollider = NodePath("CollisionShape3D")
environmentMask = 1
PathFollower = NodePath("Components/PathFollower")
Animator = NodePath("Components/Model")
Sound = NodePath("Components/Sound")
Skills = NodePath("Components/Skills")
Lockon = NodePath("Components/Lockon")

[node name="Components" type="Node3D" parent="."]

[node name="PathFollower" type="PathFollow3D" parent="Components"]
rotation_mode = 4
cubic_interp = false
loop = false
script = ExtResource("6_80hf8")

[node name="MeshInstance3D" type="MeshInstance3D" parent="Components/PathFollower"]
mesh = SubResource("SphereMesh_wrj8s")

[node name="Model" parent="Components" node_paths=PackedStringArray("animator") instance=ExtResource("12")]
script = ExtResource("11")
animator = NodePath("../../AnimationTree")

[node name="VFX" type="Node3D" parent="Components/Model"]

[node name="Sound" type="Node" parent="Components" node_paths=PackedStringArray("voiceChannel")]
script = ExtResource("15")
enClips = [ExtResource("16"), ExtResource("17")]
jaClips = [ExtResource("19"), ExtResource("18")]
actionClips = [ExtResource("20"), ExtResource("21")]
voiceChannel = NodePath("VoiceChannel")
sfxChannels = [NodePath("ActionChannel"), NodePath("FootstepChannel"), NodePath("FootstepChannel2")]

[node name="VoiceChannel" type="AudioStreamPlayer" parent="Components/Sound"]
stream = ExtResource("16")

[node name="ActionChannel" type="AudioStreamPlayer" parent="Components/Sound"]

[node name="FootstepChannel" type="AudioStreamPlayer" parent="Components/Sound"]

[node name="FootstepChannel2" type="AudioStreamPlayer" parent="Components/Sound"]

[node name="Skills" parent="Components" instance=ExtResource("13")]
speedBreakCollisionMask = 1
accelerationJumpSpeed = 24.0
landingDashSpeed = 32.0
speedBreakSpeed = 54.0

[node name="Lockon" parent="Components" instance=ExtResource("7")]

[node name="ObjectTrigger" type="Area3D" parent="Components" groups=["player"]]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, -1, 0, 1, -4.37114e-08, 0, 0.5, 0)
collision_layer = 2
collision_mask = 9

[node name="Trigger" type="CollisionShape3D" parent="Components/ObjectTrigger"]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, 1, 0, -1, -4.37114e-08, 0, 0, 0)
shape = SubResource("SphereShape3D_uookt")

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.45, 0)
shape = SubResource("80")

[node name="AnimationTree" type="AnimationTree" parent="."]
tree_root = SubResource("37")
anim_player = NodePath("../Components/Model/AnimationPlayer")
parameters/ActionState/current = 0
parameters/IsGrounded/current = 0
parameters/OneShotAnimations/Animation/current = 0
parameters/air_state/IsJumpDashing/current = 0
parameters/air_state/IsJumping/current = 0
parameters/air_state/backflip/active = false
parameters/air_state/fall/active = false
parameters/air_state/fall_reset/seek_position = -1.0
parameters/air_state/jump/active = false
parameters/air_state/jump_cancel_time/scale = 1.0
parameters/air_state/jump_dash_state/playback = SubResource("113")
parameters/countdown/active = false
parameters/ground_state/IsCrouching/current = 0
parameters/ground_state/Jog/blend_position = 0.0
parameters/ground_state/MoveSpeed/scale = 1.0
parameters/ground_state/MoveState/current = 1
parameters/ground_state/Run/blend_position = 0.0
parameters/ground_state/crouch_state/playback = SubResource("119")

[node name="AnimationPlayer" type="AnimationPlayer" parent="."]
libraries = {
"": SubResource("AnimationLibrary_3ughb")
}

[connection signal="area_entered" from="Components/ObjectTrigger" to="." method="OnObjectAreaEntered"]
[connection signal="area_exited" from="Components/ObjectTrigger" to="." method="OnObjectAreaExited"]
[connection signal="body_entered" from="Components/ObjectTrigger" to="." method="OnObjectCollisionEnter"]
[connection signal="body_exited" from="Components/ObjectTrigger" to="." method="OnObjectCollisionExit"]
