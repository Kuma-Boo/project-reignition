[gd_scene load_steps=19 format=3 uid="uid://wfh54hnc028k"]

[ext_resource type="PackedScene" uid="uid://b5jl3vv1j1fck" path="res://object/player/resource/model/Sonic.gltf" id="1_ea3e1"]
[ext_resource type="Script" path="res://object/player/resource/script/CharacterAnimator.cs" id="2_3qp24"]
[ext_resource type="PackedScene" uid="uid://gp7nom61rmtj" path="res://object/player/resource/component/Effect.tscn" id="3_5mek6"]
[ext_resource type="PackedScene" uid="uid://clet3u3mrcb8g" path="res://object/player/resource/particle/countdown/CountdownBoostParticle.tscn" id="3_hb6te"]
[ext_resource type="PackedScene" uid="uid://c2bl1sk5cfyq3" path="res://object/player/resource/particle/countdown/CountdownFlameParticle.tscn" id="4_js45q"]
[ext_resource type="AnimationLibrary" uid="uid://dhcxjlduawy8d" path="res://object/player/resource/model/animation/ActionLibrary.gltf" id="5_21j6r"]
[ext_resource type="AnimationLibrary" uid="uid://dck4cudd7a66a" path="res://object/player/resource/model/animation/BalanceLibrary.gltf" id="5_a0jad"]
[ext_resource type="AnimationLibrary" uid="uid://ql8twqq248an" path="res://object/player/resource/model/animation/SidleLibrary.gltf" id="6_pf4ty"]
[ext_resource type="AnimationLibrary" uid="uid://bo26mw8v8m0eh" path="res://object/player/resource/model/animation/EventLibrary.gltf" id="8_7bg0r"]
[ext_resource type="AnimationNodeBlendTree" uid="uid://biwe75w273iq7" path="res://object/player/resource/model/animation/animation tree/Root.tres" id="8_sfnih"]
[ext_resource type="Script" path="res://object/trigger/modules/CameraTrigger.cs" id="10_iki8q"]
[ext_resource type="Resource" uid="uid://bku7n4ufln8ro" path="res://resource/preset/camera/common/StaticCam.tres" id="11_8klty"]

[sub_resource type="Curve" id="Curve_skwgn"]
min_value = 1.0
max_value = 2.0
_data = [Vector2(0, 1.2), 0.0, 0.0, 0, 0, Vector2(0.5, 1.7), 1.5, 1.5, 0, 0, Vector2(0.8, 2), 0.0, 0.0, 0, 0, Vector2(1, 1.4), -6.5, 0.0, 0, 0]
point_count = 4

[sub_resource type="Animation" id="Animation_tuy1q"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("SonicRoot:visible")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [true]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("SonicRoot/GeneralSkeleton/ChestAttachment/FlameOffset/CountdownBoostParticle:visible")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [false]
}
tracks/2/type = "value"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("SonicRoot/GeneralSkeleton/ChestAttachment/FlameOffset/CountdownFlameParticle:visible")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [false]
}
tracks/3/type = "value"
tracks/3/imported = false
tracks/3/enabled = true
tracks/3/path = NodePath("SonicRoot/GeneralSkeleton/ChestAttachment/FlameOffset/CountdownFlameParticle:scale")
tracks/3/interp = 1
tracks/3/loop_wrap = true
tracks/3/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector3(0.1, 0.1, 0.1)]
}
tracks/4/type = "value"
tracks/4/imported = false
tracks/4/enabled = true
tracks/4/path = NodePath("CountdownCamera:position")
tracks/4/interp = 1
tracks/4/loop_wrap = true
tracks/4/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector3(0, 0, 0)]
}

[sub_resource type="Animation" id="Animation_g0fnl"]
resource_name = "countdown"
length = 4.0
step = 0.0333333
tracks/0/type = "method"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("SonicRoot/GeneralSkeleton/ChestAttachment/FlameOffset/CountdownBoostParticle")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(3.06667),
"transitions": PackedFloat32Array(1),
"values": [{
"args": [],
"method": &"restart"
}]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("SonicRoot/GeneralSkeleton/ChestAttachment/FlameOffset/CountdownBoostParticle:visible")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0, 3.06667, 4),
"transitions": PackedFloat32Array(1, 1, 1),
"update": 1,
"values": [false, true, false]
}
tracks/2/type = "value"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("SonicRoot/GeneralSkeleton/ChestAttachment/FlameOffset/CountdownFlameParticle:visible")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0, 2.13333, 4),
"transitions": PackedFloat32Array(1, 1, 1),
"update": 1,
"values": [false, true, false]
}
tracks/3/type = "value"
tracks/3/imported = false
tracks/3/enabled = true
tracks/3/path = NodePath("SonicRoot/GeneralSkeleton/ChestAttachment/FlameOffset/CountdownFlameParticle:scale")
tracks/3/interp = 1
tracks/3/loop_wrap = true
tracks/3/keys = {
"times": PackedFloat32Array(0, 2.13333, 2.2),
"transitions": PackedFloat32Array(1, 1, 1),
"update": 0,
"values": [Vector3(0, 0, 0), Vector3(0, 0, 0), Vector3(0.1, 0.1, 0.1)]
}
tracks/4/type = "value"
tracks/4/imported = false
tracks/4/enabled = true
tracks/4/path = NodePath("CountdownCamera:position")
tracks/4/interp = 1
tracks/4/loop_wrap = true
tracks/4/keys = {
"times": PackedFloat32Array(0, 0.666667, 1.5, 1.8, 2.53333, 2.8),
"transitions": PackedFloat32Array(2, 0.5, 1, 1, 1, 1),
"update": 0,
"values": [Vector3(0, 0, 2), Vector3(0, 0.5, 2), Vector3(0, 0.5, 1.9), Vector3(-0.05, 0.05, 1), Vector3(-0.05, 0.05, 1), Vector3(0, 0.4, 0.5)]
}
tracks/5/type = "bezier"
tracks/5/imported = false
tracks/5/enabled = true
tracks/5/path = NodePath("CountdownCamera:rotation:y")
tracks/5/interp = 1
tracks/5/loop_wrap = true
tracks/5/keys = {
"handle_modes": PackedInt32Array(2, 2, 2, 2, 2, 2, 2),
"points": PackedFloat32Array(0.837758, 0, 0, 0.222222, 0, 0.0872665, -0.194948, 0.116788, 0.201381, -0.120642, 0, -0.277778, 0.000191449, 0.172783, -0.000119084, 0.760034, -0.0440681, -0.0982824, 0.08521, 0.190038, 0.837758, -0.244435, 0.00233689, 0.178707, -0.00170851, -0.427705, -0.0799164, 0.0426124, 0.21145, -0.112747, -0.524, -0.4, 0, 0, 0),
"times": PackedFloat32Array(0, 0.666666, 1.5, 1.8, 2.53333, 2.8, 4)
}
tracks/6/type = "method"
tracks/6/imported = false
tracks/6/enabled = true
tracks/6/path = NodePath("CountdownCamera")
tracks/6/interp = 1
tracks/6/loop_wrap = true
tracks/6/keys = {
"times": PackedFloat32Array(0, 4),
"transitions": PackedFloat32Array(1, 1),
"values": [{
"args": [],
"method": &"Activate"
}, {
"args": [],
"method": &"Deactivate"
}]
}
tracks/7/type = "method"
tracks/7/imported = false
tracks/7/enabled = true
tracks/7/path = NodePath("Effect")
tracks/7/interp = 1
tracks/7/loop_wrap = true
tracks/7/keys = {
"times": PackedFloat32Array(0.666667),
"transitions": PackedFloat32Array(1),
"values": [{
"args": [],
"method": &"PlayLandingFX"
}]
}

[sub_resource type="Animation" id="Animation_3gene"]
resource_name = "invincibility"
length = 5.0
step = 0.0416667
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("SonicRoot:visible")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.14, 0.28, 0.42, 0.56, 0.7, 0.84, 0.98, 1.12, 1.26, 1.4, 1.54, 1.68, 1.82, 1.96, 2.1, 2.24, 2.38, 2.52, 2.66, 2.8, 2.94, 3.08, 3.22, 3.36, 3.5, 3.64, 3.78, 3.92, 4.06, 4.2, 4.34, 4.48, 4.62, 4.76, 4.9),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [false, true, false, true, false, true, false, true, false, true, false, true, false, true, false, true, false, true, false, true, false, true, false, true, false, true, false, true, false, true, false, true, false, true, false, true]
}

[sub_resource type="Animation" id="Animation_ju8e7"]
resource_name = "respawn"
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("SonicRoot:visible")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.2),
"transitions": PackedFloat32Array(1, 1),
"update": 1,
"values": [false, true]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_r0udk"]
_data = {
"RESET": SubResource("Animation_tuy1q"),
"countdown": SubResource("Animation_g0fnl"),
"invincibility": SubResource("Animation_3gene"),
"respawn": SubResource("Animation_ju8e7")
}

[node name="Sonic" node_paths=PackedStringArray("animationTree", "eventAnimationPlayer", "countdownCameraController") instance=ExtResource("1_ea3e1")]
script = ExtResource("2_3qp24")
animationTree = NodePath("AnimationTree")
eventAnimationPlayer = NodePath("EventAnimationPlayer")
countdownCameraController = NodePath("CountdownCamera")
movementAnimationSpeedCurve = SubResource("Curve_skwgn")

[node name="Effect" parent="." index="0" node_paths=PackedStringArray("rightFoot", "leftFoot") instance=ExtResource("3_5mek6")]
rightFoot = NodePath("../SonicRoot/GeneralSkeleton/RFoot/SoleOffset")
leftFoot = NodePath("../SonicRoot/GeneralSkeleton/LFoot/SoleOffset")

[node name="GeneralSkeleton" parent="SonicRoot" index="0"]
bones/2/rotation = Quaternion(0.00897831, -5.98702e-12, 1.91381e-09, 0.99996)
bones/3/rotation = Quaternion(0.704511, 6.86235e-09, -1.13115e-08, 0.709693)
bones/4/rotation = Quaternion(0.996924, 1.07903e-15, 1.37244e-14, -0.0783794)
bones/6/rotation = Quaternion(0.923503, 0.0930435, 0.0930429, -0.360317)
bones/7/rotation = Quaternion(0.923503, -0.0930431, -0.0930439, -0.360317)
bones/9/rotation = Quaternion(0.00762178, 0.70522, -0.0119404, 0.708847)
bones/10/rotation = Quaternion(0.00230452, -0.69927, 0.00217972, 0.714851)
bones/11/rotation = Quaternion(0.55867, 0.762376, -0.0946179, -0.312598)
bones/12/rotation = Quaternion(0.00527088, 0.0365675, -0.0021433, 0.999315)
bones/13/position = Vector3(0.0471311, 0.131563, 0.0147976)
bones/13/rotation = Quaternion(0.0274164, 0.0283704, -0.0518214, 0.997877)
bones/14/rotation = Quaternion(0.00294868, 0.00678223, -0.000281789, 0.999973)
bones/15/rotation = Quaternion(0.014017, 0.00409222, 0.00361266, 0.999887)
bones/16/position = Vector3(-0.0258128, 0.131441, 0.0203244)
bones/16/rotation = Quaternion(0.00308571, 0.00362121, 0.0545011, 0.998502)
bones/17/rotation = Quaternion(0.0167333, 0.0107753, 0.000105142, 0.999802)
bones/18/rotation = Quaternion(0.0249171, 0.00388378, 0.000898508, 0.999682)
bones/19/position = Vector3(0.0105133, 0.134816, 0.0251114)
bones/20/rotation = Quaternion(0.00122096, 0.00794685, 6.0618e-05, 0.999968)
bones/21/rotation = Quaternion(0.00959978, -0.00273355, 0.000526762, 0.99995)
bones/22/rotation = Quaternion(0.0130255, 0.00734399, 0.117758, 0.99293)
bones/23/rotation = Quaternion(-0.00150023, 0.00739151, -0.000392204, 0.999972)
bones/24/rotation = Quaternion(0.00834599, -0.0104869, 0.000889611, 0.99991)
bones/25/rotation = Quaternion(-0.507969, 0.493849, 0.492113, 0.505871)
bones/26/rotation = Quaternion(0.00761439, -0.70522, 0.0119288, 0.708847)
bones/26/scale = Vector3(1, 0.999999, 1)
bones/27/rotation = Quaternion(0.00230789, 0.69927, -0.00217438, 0.714851)
bones/29/rotation = Quaternion(0.00527071, -0.0365676, 0.00214331, 0.999315)
bones/31/rotation = Quaternion(0.00294867, -0.00678224, 0.000281738, 0.999973)
bones/34/rotation = Quaternion(0.0167333, -0.0107753, -0.000105105, 0.999802)
bones/36/position = Vector3(-0.0105133, 0.134816, 0.0251114)
bones/37/rotation = Quaternion(0.00122097, -0.00794686, -6.06105e-05, 0.999968)
bones/38/rotation = Quaternion(0.00959979, 0.00273354, -0.000526762, 0.99995)
bones/41/rotation = Quaternion(0.00834599, 0.0104869, -0.000889615, 0.99991)
bones/43/rotation = Quaternion(-0.643831, -1.6904e-06, -1.6904e-06, 0.765168)
bones/44/rotation = Quaternion(-0.19973, -2.76456e-07, 2.35476e-06, 0.979851)
bones/45/rotation = Quaternion(-0.797272, -3.17443e-06, -3.17443e-06, 0.60362)
bones/47/rotation = Quaternion(-0.724152, -0.0852654, -0.0852654, 0.679016)
bones/48/rotation = Quaternion(-0.253687, 0.0999926, -0.0414427, 0.961211)
bones/49/rotation = Quaternion(0.860133, 0.123618, 0.123618, -0.479176)
bones/50/rotation = Quaternion(-0.151181, 0.0372496, 0.0645466, 0.985693)
bones/51/rotation = Quaternion(0.860133, -0.123618, -0.123618, -0.479176)
bones/52/rotation = Quaternion(-0.151181, -0.0372496, -0.0645466, 0.985693)
bones/53/rotation = Quaternion(-0.724152, 0.0852654, 0.0852654, 0.679016)
bones/54/rotation = Quaternion(-0.253687, -0.0999927, 0.0414427, 0.961211)
bones/56/rotation = Quaternion(0.999986, 2.97474e-07, -1.92112e-07, 0.0053232)
bones/57/rotation = Quaternion(0.00899519, -2.3455e-12, -2.37187e-09, 0.99996)
bones/58/rotation = Quaternion(0.704506, 8.15635e-09, -9.99258e-09, 0.709699)
bones/59/rotation = Quaternion(0.996924, -1.09643e-15, -1.39458e-14, -0.0783794)

[node name="BodyMesh" parent="SonicRoot/GeneralSkeleton" index="0"]
layers = 64

[node name="LEye" parent="SonicRoot/GeneralSkeleton" index="1"]
layers = 64

[node name="REye" parent="SonicRoot/GeneralSkeleton" index="2"]
layers = 64

[node name="RingMesh" parent="SonicRoot/GeneralSkeleton" index="3"]
layers = 64

[node name="ChestAttachment" type="BoneAttachment3D" parent="SonicRoot/GeneralSkeleton" index="4"]
transform = Transform3D(1, 7.92686e-07, -7.92686e-07, -7.92686e-07, 1, 1.59254e-08, 7.92686e-07, -1.59248e-08, 1, 5.80681e-08, 0.554189, -2.23517e-08)
bone_name = "chest"
bone_idx = 5

[node name="FlameOffset" type="Node3D" parent="SonicRoot/GeneralSkeleton/ChestAttachment" index="0"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.02, 0, 0.1)

[node name="CountdownBoostParticle" parent="SonicRoot/GeneralSkeleton/ChestAttachment/FlameOffset" index="0" instance=ExtResource("3_hb6te")]
transform = Transform3D(0.1, 0, 0, 0, 0.1, 0, 0, 0, 0.1, 0, 0, 0)
visible = false

[node name="CountdownFlameParticle" parent="SonicRoot/GeneralSkeleton/ChestAttachment/FlameOffset" index="1" instance=ExtResource("4_js45q")]
transform = Transform3D(0.1, 0, 0, 0, 0.1, 0, 0, 0, 0.1, 0, 0, 0)
visible = false

[node name="RFoot" type="BoneAttachment3D" parent="SonicRoot/GeneralSkeleton" index="5"]
transform = Transform3D(1, -1.02496e-12, -6.143e-13, 6.16757e-13, 2.03494e-07, 0.999999, -9.71667e-13, -0.999998, 2.21189e-07, -0.0397276, 0.155469, 0.00205613)
bone_name = "r_foot"
bone_idx = 58

[node name="SoleOffset" type="Node3D" parent="SonicRoot/GeneralSkeleton/RFoot" index="0"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.01, -0.085, -0.15)

[node name="LFoot" type="BoneAttachment3D" parent="SonicRoot/GeneralSkeleton" index="6"]
transform = Transform3D(1, 1.06581e-14, 6.15422e-12, -6.2165e-12, 1.07381e-06, 1, 1.33227e-13, -1, 1.07894e-06, 0.0397276, 0.155469, 0.00205613)
bone_name = "l_foot"
bone_idx = 3

[node name="SoleOffset" type="Node3D" parent="SonicRoot/GeneralSkeleton/LFoot" index="0"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.01, -0.085, -0.15)

[node name="AnimationPlayer" type="AnimationPlayer" parent="." index="2"]
libraries = {
"ActionLibrary": ExtResource("5_21j6r"),
"BalanceLibrary": ExtResource("5_a0jad"),
"EventLibrary": ExtResource("8_7bg0r"),
"SidleLibrary": ExtResource("6_pf4ty")
}

[node name="EventAnimationPlayer" type="AnimationPlayer" parent="." index="3"]
callback_mode_process = 0
libraries = {
"": SubResource("AnimationLibrary_r0udk")
}

[node name="CountdownCamera" type="Node3D" parent="." index="4"]
transform = Transform3D(0.996195, 0, 0.0871558, 0, 1, 0, -0.0871558, 0, 0.996195, 0, 0, 0)
script = ExtResource("10_iki8q")
UpdateEveryFrame = true
settings = ExtResource("11_8klty")

[node name="AnimationTree" type="AnimationTree" parent="." index="5"]
active = false
libraries = {
"ActionLibrary": ExtResource("5_21j6r"),
"BalanceLibrary": ExtResource("5_a0jad"),
"EventLibrary": ExtResource("8_7bg0r"),
"SidleLibrary": ExtResource("6_pf4ty")
}
tree_root = ExtResource("8_sfnih")
anim_player = NodePath("../AnimationPlayer")
parameters/balance_tree/balance_speed/scale = 1.0
parameters/balance_tree/balance_state/balance_left_blend/blend_position = 0
parameters/balance_tree/balance_state/balance_right_blend/blend_position = 0
parameters/balance_tree/grindstep_speed/scale = 1.2
parameters/balance_tree/grindstep_transition/current_state = "pose-01"
parameters/balance_tree/grindstep_transition/transition_request = "pose-01"
parameters/balance_tree/grindstep_transition/current_index = 0
parameters/balance_tree/grindstep_trigger/active = false
parameters/balance_tree/grindstep_trigger/internal_active = false
parameters/balance_tree/grindstep_trigger/request = 0
parameters/balance_tree/wind_add/add_amount = 1.0
parameters/balance_tree/wind_blend/blend_position = 0.0
parameters/drift_tree/direction_transition/current_state = "left"
parameters/drift_tree/direction_transition/transition_request = ""
parameters/drift_tree/direction_transition/current_index = 0
parameters/normal_state/ground_tree/backstep_seek/seek_request = -1.0
parameters/normal_state/ground_tree/crouch_transition/current_state = "disabled"
parameters/normal_state/ground_tree/crouch_transition/transition_request = ""
parameters/normal_state/ground_tree/crouch_transition/current_index = 0
parameters/normal_state/ground_tree/forward_blend/blend_position = 0.0
parameters/normal_state/ground_tree/forward_seek/seek_request = -1.0
parameters/normal_state/ground_tree/ground_seek/seek_request = -1.0
parameters/normal_state/ground_tree/ground_speed/scale = 1.0
parameters/normal_state/ground_tree/idle_blend/blend_amount = 0.0
parameters/normal_state/ground_tree/land_speed/scale = 1.5
parameters/normal_state/ground_tree/land_trigger/active = false
parameters/normal_state/ground_tree/land_trigger/internal_active = false
parameters/normal_state/ground_tree/land_trigger/request = 0
parameters/normal_state/ground_tree/turn_add/add_amount = 1.0
parameters/normal_state/ground_tree/turn_blend/blend_position = Vector2(0, 0)
parameters/oneshot_tree/oneshot_seek/seek_request = -1.0
parameters/oneshot_tree/oneshot_transition/current_state = "countdown"
parameters/oneshot_tree/oneshot_transition/transition_request = ""
parameters/oneshot_tree/oneshot_transition/current_index = 0
parameters/oneshot_trigger/active = false
parameters/oneshot_trigger/internal_active = false
parameters/oneshot_trigger/request = 0
parameters/sidle_tree/direction_transition/current_state = "right"
parameters/sidle_tree/direction_transition/transition_request = ""
parameters/sidle_tree/direction_transition/current_index = 0
parameters/sidle_tree/sidle_seek/seek_request = -1.0
parameters/sidle_tree/sidle_speed/scale = 0.0
parameters/state_transition/current_state = "normal"
parameters/state_transition/transition_request = ""
parameters/state_transition/current_index = 0
