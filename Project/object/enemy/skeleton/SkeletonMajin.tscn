[gd_scene load_steps=40 format=3 uid="uid://c7s3kkj8pq6ox"]

[ext_resource type="Script" uid="uid://xoterrnak5w1" path="res://object/enemy/skeleton/data/SkeletonMajin.cs" id="1_73oxv"]
[ext_resource type="PackedScene" uid="uid://chpp4pf0r6nsb" path="res://object/enemy/skeleton/data/model/SkeletonMajin.gltf" id="1_84j8u"]
[ext_resource type="PackedScene" uid="uid://dwlm87ss0cwxm" path="res://object/enemy/skeleton/data/model/MajinPieces.gltf" id="3_742ge"]
[ext_resource type="Script" uid="uid://bj7jhdknn12cl" path="res://object/stage/destructable/resource/script/DestructableObject.cs" id="3_e8p5l"]
[ext_resource type="Script" uid="uid://cp6er04j2b86u" path="res://object/enemy/EnemyHurtbox.cs" id="4_dyuvb"]

[sub_resource type="Curve" id="Curve_2u1g0"]
_limits = [0.0, 8.0, 0.0, 1.0]
bake_resolution = 1
_data = [Vector2(0, 0), 0.0, 0.0, 0, 0, Vector2(0.3, 0), 0.0, 0.0, 0, 0, Vector2(0.5, 2.4), 0.0, 0.0, 0, 0, Vector2(0.8, 4), 18.0, 18.0, 0, 0, Vector2(1, 8), 0.0, 0.0, 0, 0]
point_count = 5

[sub_resource type="SphereShape3D" id="SphereShape3D_xm0ol"]
radius = 0.4

[sub_resource type="CylinderShape3D" id="CylinderShape3D_4f7fu"]
radius = 0.15

[sub_resource type="CylinderShape3D" id="CylinderShape3D_fg78d"]
height = 0.8
radius = 0.4

[sub_resource type="Animation" id="Animation_o56xt"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("SkeletonMajin:visible")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [true]
}

[sub_resource type="Animation" id="Animation_t78yr"]
resource_name = "shatter"
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("SkeletonMajin:visible")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [false]
}
tracks/1/type = "method"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath(".")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(1),
"transitions": PackedFloat32Array(1),
"values": [{
"args": [],
"method": &"Despawn"
}]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_4k2km"]
_data = {
&"RESET": SubResource("Animation_o56xt"),
&"shatter": SubResource("Animation_t78yr")
}

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_qgmxb"]
animation = &"attack-start"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_sw50w"]
animation = &"attack-stop"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_kbpyb"]
animation = &"attack"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_ekin1"]
animation = &"damage"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_e2dlr"]
animation = &"defeat"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_csure"]
animation = &"idle"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_28jlw"]
animation = &"overhead"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_wpuis"]
animation = &"shatter-reset"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_hutrf"]
animation = &"spawn"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_rxhx1"]
animation = &"walk"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_h360r"]

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_xhd0m"]

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_qbqno"]
xfade_time = 0.5
switch_mode = 2
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_kw7dt"]
xfade_time = 0.1

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_nj5sa"]
xfade_time = 0.05

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_28jlw"]
xfade_time = 0.1

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_rxhx1"]
xfade_time = 0.1
switch_mode = 2
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_r78uq"]
xfade_time = 0.1
break_loop_at_end = true
switch_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_sw50w"]
xfade_time = 0.5
switch_mode = 2
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_kb1n2"]
xfade_time = 0.2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_l5hdd"]
xfade_time = 0.2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_ok4iv"]
xfade_time = 0.2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_noghd"]
xfade_time = 0.2
switch_mode = 2
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_qgmxb"]
switch_mode = 2

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_7hob3"]
states/attack/node = SubResource("AnimationNodeAnimation_kbpyb")
states/attack/position = Vector2(364.028, 348.413)
states/attack-start/node = SubResource("AnimationNodeAnimation_qgmxb")
states/attack-start/position = Vector2(215.803, 348.413)
states/attack-stop/node = SubResource("AnimationNodeAnimation_sw50w")
states/attack-stop/position = Vector2(497.103, 348.413)
states/damage/node = SubResource("AnimationNodeAnimation_ekin1")
states/damage/position = Vector2(497.103, 237.793)
states/defeat/node = SubResource("AnimationNodeAnimation_e2dlr")
states/defeat/position = Vector2(497.103, 166.8)
states/idle/node = SubResource("AnimationNodeAnimation_csure")
states/idle/position = Vector2(364.028, 237.793)
states/overhead/node = SubResource("AnimationNodeAnimation_28jlw")
states/overhead/position = Vector2(200, 166.8)
states/shatter-reset/node = SubResource("AnimationNodeAnimation_wpuis")
states/shatter-reset/position = Vector2(361.6, 99.44)
states/spawn/node = SubResource("AnimationNodeAnimation_hutrf")
states/spawn/position = Vector2(361.44, 166.8)
states/walk/node = SubResource("AnimationNodeAnimation_rxhx1")
states/walk/position = Vector2(200, 237.793)
transitions = ["Start", "shatter-reset", SubResource("AnimationNodeStateMachineTransition_h360r"), "shatter-reset", "spawn", SubResource("AnimationNodeStateMachineTransition_xhd0m"), "spawn", "idle", SubResource("AnimationNodeStateMachineTransition_qbqno"), "idle", "damage", SubResource("AnimationNodeStateMachineTransition_kw7dt"), "idle", "defeat", SubResource("AnimationNodeStateMachineTransition_nj5sa"), "idle", "attack-start", SubResource("AnimationNodeStateMachineTransition_28jlw"), "attack-start", "attack", SubResource("AnimationNodeStateMachineTransition_rxhx1"), "attack", "attack-stop", SubResource("AnimationNodeStateMachineTransition_r78uq"), "attack-stop", "idle", SubResource("AnimationNodeStateMachineTransition_sw50w"), "idle", "walk", SubResource("AnimationNodeStateMachineTransition_kb1n2"), "walk", "idle", SubResource("AnimationNodeStateMachineTransition_l5hdd"), "idle", "overhead", SubResource("AnimationNodeStateMachineTransition_ok4iv"), "overhead", "idle", SubResource("AnimationNodeStateMachineTransition_noghd"), "damage", "spawn", SubResource("AnimationNodeStateMachineTransition_qgmxb")]
graph_offset = Vector2(-331, 72)

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_u22e4"]
radius = 0.4

[sub_resource type="CylinderShape3D" id="CylinderShape3D_6u6cp"]
height = 15.0
radius = 25.0

[node name="SkeletonMajin" type="StaticBody3D"]
collision_layer = 8
collision_mask = 2
script = ExtResource("1_73oxv")
attackDelayCurve = SubResource("Curve_2u1g0")
pearlAmount = 15
damagePlayer = true
root = NodePath("Root")
hurtbox = NodePath("Root/SkeletonMajin/SkeletonMajinRoot/Skeleton3D/Head/Hurtbox")
collider = NodePath("CollisionShape3D")
rangeCollider = NodePath("Range/CollisionShape3D")
animationTree = NodePath("AnimationTree")
animationPlayer = NodePath("")

[node name="Root" type="Node3D" parent="." node_paths=PackedStringArray("root", "pieceRoot", "animator")]
script = ExtResource("3_e8p5l")
pieceMass = 5.0
root = NodePath("SkeletonMajin")
pieceRoot = NodePath("MajinPieces")
animator = NodePath("ShatterAnimator")

[node name="SkeletonMajin" parent="Root" instance=ExtResource("1_84j8u")]

[node name="Head" type="BoneAttachment3D" parent="Root/SkeletonMajin/SkeletonMajinRoot/Skeleton3D" index="1"]
transform = Transform3D(1, -1.00692e-07, 3.39116e-07, 1.0069e-07, 0.99998, 6.38701e-06, -3.39114e-07, 5.06267e-06, 1.00002, -6.8964e-08, 2.44999, -0.109997)
bone_name = "head"
bone_idx = 5

[node name="Hurtbox" type="Area3D" parent="Root/SkeletonMajin/SkeletonMajinRoot/Skeleton3D/Head" node_paths=PackedStringArray("enemy")]
transform = Transform3D(1, -4.87002e-15, 0, 6.02686e-15, 1, 0, 0, -1.81899e-12, 1, -1.42109e-14, 0.0999997, 0.1)
collision_layer = 12
collision_mask = 2
script = ExtResource("4_dyuvb")
enemy = NodePath("../../../../../..")

[node name="CollisionShape3D" type="CollisionShape3D" parent="Root/SkeletonMajin/SkeletonMajinRoot/Skeleton3D/Head/Hurtbox"]
transform = Transform3D(1, -1.71304e-16, 0, 3.14505e-15, 1, 0, 0, -4.54747e-13, 1, 0, 0, 0)
shape = SubResource("SphereShape3D_xm0ol")

[node name="LSword" type="BoneAttachment3D" parent="Root/SkeletonMajin/SkeletonMajinRoot/Skeleton3D" index="2"]
transform = Transform3D(9.57127e-08, 1.00001, -3.05617e-08, 0.999989, -9.19356e-08, -5.02069e-06, 6.44945e-06, -3.15897e-08, -0.999998, 1.14498, 2.09403, 8.16423e-07)
bone_name = "l_arm02"
bone_idx = 9

[node name="Hitbox" type="Area3D" parent="Root/SkeletonMajin/SkeletonMajinRoot/Skeleton3D/LSword" node_paths=PackedStringArray("enemy")]
collision_layer = 12
collision_mask = 2
monitorable = false
script = ExtResource("4_dyuvb")
enemy = NodePath("../../../../../..")

[node name="CollisionShape3D" type="CollisionShape3D" parent="Root/SkeletonMajin/SkeletonMajinRoot/Skeleton3D/LSword/Hitbox"]
transform = Transform3D(1, 2.61943e-15, 0, 3.324e-14, 1, 7.10543e-15, 0, -4.54747e-13, 1, 0, 1, 0)
shape = SubResource("CylinderShape3D_4f7fu")

[node name="RSword" type="BoneAttachment3D" parent="Root/SkeletonMajin/SkeletonMajinRoot/Skeleton3D" index="3"]
transform = Transform3D(1.08051e-07, -1.00001, 3.20808e-08, -0.999999, -1.03442e-07, -5.02439e-06, -6.44578e-06, -3.30957e-08, -0.999989, -1.14498, 2.09403, 7.90907e-07)
bone_name = "r_arm02"
bone_idx = 11

[node name="Hitbox" type="Area3D" parent="Root/SkeletonMajin/SkeletonMajinRoot/Skeleton3D/RSword" node_paths=PackedStringArray("enemy")]
collision_layer = 12
collision_mask = 2
monitorable = false
script = ExtResource("4_dyuvb")
enemy = NodePath("../../../../../..")

[node name="CollisionShape3D" type="CollisionShape3D" parent="Root/SkeletonMajin/SkeletonMajinRoot/Skeleton3D/RSword/Hitbox"]
transform = Transform3D(1, 2.61943e-15, 0, 3.324e-14, 1, 7.10543e-15, 0, -4.54747e-13, 1, 0, 1, 0)
shape = SubResource("CylinderShape3D_4f7fu")

[node name="Chest" type="BoneAttachment3D" parent="Root/SkeletonMajin/SkeletonMajinRoot/Skeleton3D" index="4"]
transform = Transform3D(1, -3.87003e-09, 4.00409e-09, 4.00447e-09, 0.999409, -0.0342849, -3.8693e-09, 0.0342966, 0.999414, 5.80307e-09, 1.74, -0.130001)
bone_name = "chest"
bone_idx = 3

[node name="Hitbox" type="Area3D" parent="Root/SkeletonMajin/SkeletonMajinRoot/Skeleton3D/Chest" node_paths=PackedStringArray("enemy")]
transform = Transform3D(1, 4.85723e-16, 0, 4.16334e-17, 1, 0, 0, 0, 1, 0, 0, 0)
collision_layer = 12
collision_mask = 2
monitorable = false
script = ExtResource("4_dyuvb")
enemy = NodePath("../../../../../..")

[node name="CollisionShape3D" type="CollisionShape3D" parent="Root/SkeletonMajin/SkeletonMajinRoot/Skeleton3D/Chest/Hitbox"]
shape = SubResource("CylinderShape3D_fg78d")
disabled = true

[node name="Root" type="BoneAttachment3D" parent="Root/SkeletonMajin/SkeletonMajinRoot/Skeleton3D" index="5"]
transform = Transform3D(1, 0, 0, 0, 0, 1, 0, -1, 0, 0, 0, 0)
bone_name = "root"
bone_idx = 0

[node name="Hitbox" type="Area3D" parent="Root/SkeletonMajin/SkeletonMajinRoot/Skeleton3D/Root" node_paths=PackedStringArray("enemy")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0.5)
collision_layer = 12
collision_mask = 2
monitorable = false
script = ExtResource("4_dyuvb")
enemy = NodePath("../../../../../..")

[node name="CollisionShape3D" type="CollisionShape3D" parent="Root/SkeletonMajin/SkeletonMajinRoot/Skeleton3D/Root/Hitbox"]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, -1, 0, 1, -4.37114e-08, 0, 0, 0)
shape = SubResource("CylinderShape3D_fg78d")

[node name="MajinPieces" parent="Root" instance=ExtResource("3_742ge")]
visible = false

[node name="ShatterAnimator" type="AnimationPlayer" parent="Root"]
libraries = {
&"": SubResource("AnimationLibrary_4k2km")
}

[node name="AnimationTree" type="AnimationTree" parent="."]
active = false
root_node = NodePath("../Root/SkeletonMajin")
tree_root = SubResource("AnimationNodeStateMachine_7hob3")
anim_player = NodePath("../Root/SkeletonMajin/AnimationPlayer")

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
shape = SubResource("CapsuleShape3D_u22e4")

[node name="Range" type="Area3D" parent="."]
collision_layer = 0
collision_mask = 2
monitorable = false

[node name="CollisionShape3D" type="CollisionShape3D" parent="Range"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 5, 0)
shape = SubResource("CylinderShape3D_6u6cp")

[connection signal="area_entered" from="Root/SkeletonMajin/SkeletonMajinRoot/Skeleton3D/Head/Hurtbox" to="." method="OnHurtboxEntered"]
[connection signal="area_exited" from="Root/SkeletonMajin/SkeletonMajinRoot/Skeleton3D/Head/Hurtbox" to="." method="OnHurtboxExited"]
[connection signal="area_entered" from="Root/SkeletonMajin/SkeletonMajinRoot/Skeleton3D/LSword/Hitbox" to="." method="OnEntered"]
[connection signal="area_exited" from="Root/SkeletonMajin/SkeletonMajinRoot/Skeleton3D/LSword/Hitbox" to="." method="OnExited"]
[connection signal="area_entered" from="Root/SkeletonMajin/SkeletonMajinRoot/Skeleton3D/RSword/Hitbox" to="." method="OnEntered"]
[connection signal="area_exited" from="Root/SkeletonMajin/SkeletonMajinRoot/Skeleton3D/RSword/Hitbox" to="." method="OnExited"]
[connection signal="area_entered" from="Root/SkeletonMajin/SkeletonMajinRoot/Skeleton3D/Chest/Hitbox" to="." method="OnEntered"]
[connection signal="area_exited" from="Root/SkeletonMajin/SkeletonMajinRoot/Skeleton3D/Chest/Hitbox" to="." method="OnExited"]
[connection signal="area_entered" from="Root/SkeletonMajin/SkeletonMajinRoot/Skeleton3D/Root/Hitbox" to="." method="OnEntered"]
[connection signal="area_exited" from="Root/SkeletonMajin/SkeletonMajinRoot/Skeleton3D/Root/Hitbox" to="." method="OnExited"]
[connection signal="area_entered" from="Range" to="." method="OnRangeEntered"]
[connection signal="area_exited" from="Range" to="." method="OnRangeExited"]

[editable path="Root/SkeletonMajin"]
