[gd_scene load_steps=31 format=2]

[ext_resource path="res://area/stage/7 night palace/boss/data/path/MainPath.tres" type="Curve3D" id=1]
[ext_resource path="res://area/stage/7 night palace/data/model/NPSky.gltf" type="PackedScene" id=2]
[ext_resource path="res://area/stage/7 night palace/data/model/NPBoss.gltf" type="PackedScene" id=3]
[ext_resource path="res://area/stage/7 night palace/data/WorldEnvironment.tres" type="Environment" id=4]
[ext_resource path="res://area/stage/7 night palace/data/music/BossBGM.tscn" type="PackedScene" id=5]
[ext_resource path="res://area/stage/7 night palace/data/model/NPBossLOD.gltf" type="PackedScene" id=6]
[ext_resource path="res://addons/Silicon.vfx.planar_reflection/planar_reflector.gd" type="Script" id=7]
[ext_resource path="res://area/stage/7 night palace/data/model/Reflection.tres" type="Material" id=8]
[ext_resource path="res://area/stage/7 night palace/boss/data/object/Erazor.tscn" type="PackedScene" id=9]
[ext_resource path="res://object/player/CharacterSpawn.tscn" type="PackedScene" id=10]
[ext_resource path="res://object/trigger/StageTrigger.tscn" type="PackedScene" id=11]
[ext_resource path="res://object/trigger/modules/PathTrigger.cs" type="Script" id=12]
[ext_resource path="res://object/trigger/modules/CheckpointTrigger.cs" type="Script" id=13]
[ext_resource path="res://object/stage/StageSettings.cs" type="Script" id=14]
[ext_resource path="res://area/stage/7 night palace/boss/data/script/InfiniteHallway.cs" type="Script" id=15]
[ext_resource path="res://area/stage/7 night palace/boss/data/object/ItemBundle.tscn" type="PackedScene" id=16]
[ext_resource path="res://object/player/resource/movement settings/AutoRun.tres" type="Resource" id=17]
[ext_resource path="res://object/trigger/modules/LockoutTrigger.cs" type="Script" id=18]
[ext_resource path="res://area/stage/7 night palace/boss/data/reflection/follow_roughness.png" type="Texture" id=19]

[sub_resource type="SphereShape" id=9]
radius = 3.0

[sub_resource type="BoxShape" id=10]
extents = Vector3( 8, 14, 1 )

[sub_resource type="ArrayMesh" id=11]
resource_name = "NPBossCollision_Floor"
surfaces/0 = {
"aabb": AABB( -5.41997, -0.000161636, -88.1306, 10.8721, 0.000328673, 88.0315 ),
"array_data": PoolByteArray( 100, 112, 173, 192, 91, 170, 36, 57, 218, 66, 176, 194, 0, 0, 254, 127, 100, 112, 173, 192, 213, 124, 41, 185, 0, 218, 202, 189, 0, 0, 254, 127, 156, 119, 174, 64, 91, 170, 36, 57, 218, 66, 176, 194, 0, 0, 254, 127, 156, 119, 174, 64, 213, 124, 41, 185, 0, 218, 202, 189, 0, 0, 254, 127 ),
"array_index_data": PoolByteArray( 0, 0, 3, 0, 1, 0, 0, 0, 2, 0, 3, 0 ),
"blend_shape_data": [  ],
"format": 2194691,
"index_count": 6,
"primitive": 4,
"skeleton_aabb": [  ],
"vertex_count": 4
}

[sub_resource type="ConcavePolygonShape" id=12]
data = PoolVector3Array( -5.42, 0.0002, -88.1306, 5.4521, -0.0002, -0.099, -5.42, -0.0002, -0.099, -5.42, 0.0002, -88.1306, 5.4521, 0.0002, -88.1306, 5.4521, -0.0002, -0.099 )

[sub_resource type="ArrayMesh" id=13]
resource_name = "NPBossCollision_Wall"
surfaces/0 = {
"aabb": AABB( -5.41997, -0.000161636, -88.1306, 10.8721, 20.0003, 88.0315 ),
"array_data": PoolByteArray( 100, 112, 173, 192, 91, 170, 36, 57, 218, 66, 176, 194, 255, 127, 0, 0, 100, 112, 173, 192, 213, 124, 41, 185, 0, 218, 202, 189, 255, 127, 0, 0, 156, 119, 174, 64, 91, 170, 36, 57, 218, 66, 176, 194, 1, 128, 0, 0, 156, 119, 174, 64, 213, 124, 41, 185, 0, 218, 202, 189, 1, 128, 0, 0, 100, 112, 173, 192, 82, 0, 160, 65, 218, 66, 176, 194, 255, 127, 0, 0, 100, 112, 173, 192, 171, 255, 159, 65, 0, 218, 202, 189, 255, 127, 0, 0, 156, 119, 174, 64, 82, 0, 160, 65, 218, 66, 176, 194, 1, 128, 0, 0, 156, 119, 174, 64, 171, 255, 159, 65, 0, 218, 202, 189, 1, 128, 0, 0 ),
"array_index_data": PoolByteArray( 1, 0, 4, 0, 0, 0, 1, 0, 5, 0, 4, 0, 2, 0, 7, 0, 3, 0, 2, 0, 6, 0, 7, 0 ),
"blend_shape_data": [  ],
"format": 2194691,
"index_count": 12,
"primitive": 4,
"skeleton_aabb": [  ],
"vertex_count": 8
}

[sub_resource type="ConcavePolygonShape" id=14]
data = PoolVector3Array( -5.42, -0.0002, -0.099, -5.42, 20.0002, -88.1306, -5.42, 0.0002, -88.1306, -5.42, -0.0002, -0.099, -5.42, 19.9998, -0.099, -5.42, 20.0002, -88.1306, 5.4521, 0.0002, -88.1306, 5.4521, 19.9998, -0.099, 5.4521, -0.0002, -0.099, 5.4521, 0.0002, -88.1306, 5.4521, 20.0002, -88.1306, 5.4521, 19.9998, -0.099 )

[sub_resource type="SpatialMaterial" id=1]
vertex_color_use_as_albedo = true

[sub_resource type="ArrayMesh" id=2]
resource_name = "NPBossReflection_ReflectionMesh"
surfaces/0 = {
"aabb": AABB( -23.7989, 0.159912, 0.0298386, 49.4805, 87.984, 0.263612 ),
"array_data": PoolByteArray( 25, 100, 190, 193, 180, 73, 176, 66, 202, 61, 150, 62, 0, 0, 0, 0, 8, 8, 8, 255, 25, 100, 190, 193, 1, 192, 35, 62, 234, 20, 150, 62, 0, 0, 0, 0, 8, 8, 8, 255, 100, 56, 185, 192, 1, 192, 35, 62, 234, 20, 150, 62, 0, 0, 0, 0, 8, 8, 8, 255, 100, 56, 185, 192, 180, 73, 176, 66, 202, 61, 150, 62, 0, 0, 0, 0, 8, 8, 8, 255, 100, 120, 173, 192, 180, 73, 176, 66, 16, 254, 246, 60, 0, 0, 0, 0, 8, 8, 8, 255, 100, 120, 173, 192, 0, 192, 35, 62, 0, 112, 244, 60, 0, 0, 0, 0, 8, 8, 8, 255, 156, 115, 174, 64, 0, 192, 35, 62, 0, 112, 244, 60, 0, 0, 0, 0, 8, 8, 8, 255, 156, 115, 174, 64, 180, 73, 176, 66, 16, 254, 246, 60, 0, 0, 0, 0, 8, 8, 8, 255, 156, 51, 186, 64, 180, 73, 176, 66, 202, 61, 150, 62, 0, 0, 0, 0, 8, 8, 8, 255, 156, 51, 186, 64, 1, 192, 35, 62, 234, 20, 150, 62, 0, 0, 0, 0, 8, 8, 8, 255, 231, 115, 205, 65, 1, 192, 35, 62, 234, 20, 150, 62, 0, 0, 0, 0, 8, 8, 8, 255, 231, 115, 205, 65, 180, 73, 176, 66, 202, 61, 150, 62, 0, 0, 0, 0, 8, 8, 8, 255 ),
"array_index_data": PoolByteArray( 4, 0, 6, 0, 5, 0, 4, 0, 7, 0, 6, 0, 3, 0, 1, 0, 0, 0, 3, 0, 2, 0, 1, 0, 10, 0, 8, 0, 11, 0, 10, 0, 9, 0, 8, 0 ),
"blend_shape_data": [  ],
"format": 2194699,
"index_count": 18,
"material": SubResource( 1 ),
"primitive": 4,
"skeleton_aabb": [  ],
"vertex_count": 12
}

[sub_resource type="SpatialMaterial" id=15]
vertex_color_use_as_albedo = true
params_specular_mode = 4
params_blend_mode = 1
metallic = 1.0
metallic_specular = 1.0
roughness_texture = ExtResource( 19 )

[sub_resource type="SpatialMaterial" id=3]
vertex_color_use_as_albedo = true

[sub_resource type="ArrayMesh" id=4]
resource_name = "NPBossReflection_ReflectionHighResMesh"
surfaces/0 = {
"aabb": AABB( -6, -6, 0, 12, 12, 0.0301604 ),
"array_data": PoolByteArray( 0, 0, 192, 192, 2, 0, 192, 64, 16, 254, 246, 60, 0, 0, 129, 63, 8, 8, 8, 255, 255, 59, 255, 59, 0, 0, 192, 192, 0, 0, 192, 192, 0, 0, 0, 128, 0, 0, 130, 63, 8, 8, 8, 255, 255, 59, 142, 6, 0, 0, 192, 64, 0, 0, 192, 192, 0, 0, 0, 128, 0, 0, 129, 63, 8, 8, 8, 255, 141, 6, 143, 6, 0, 0, 192, 64, 2, 0, 192, 64, 16, 254, 246, 60, 0, 0, 130, 63, 8, 8, 8, 255, 147, 6, 255, 59 ),
"array_index_data": PoolByteArray( 0, 0, 2, 0, 1, 0, 0, 0, 3, 0, 2, 0 ),
"blend_shape_data": [  ],
"format": 2194719,
"index_count": 6,
"material": SubResource( 3 ),
"primitive": 4,
"skeleton_aabb": [  ],
"vertex_count": 4
}

[node name="Stage" type="Node"]

[node name="Objects" type="Spatial" parent="."]
script = ExtResource( 14 )

[node name="CharacterSpawn" parent="Objects" instance=ExtResource( 10 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -49 )

[node name="Lockout" type="Spatial" parent="Objects/CharacterSpawn"]
script = ExtResource( 18 )
lockoutData = ExtResource( 17 )

[node name="SpawnTrigger" parent="Objects/CharacterSpawn" instance=ExtResource( 11 )]
isOneShot = true

[node name="Path" type="Spatial" parent="Objects/CharacterSpawn/SpawnTrigger"]
script = ExtResource( 12 )
path = NodePath("../../../../Paths/MainPath")

[node name="CollisionShape" type="CollisionShape" parent="Objects/CharacterSpawn/SpawnTrigger"]
shape = SubResource( 9 )

[node name="Checkpoint" type="Spatial" parent="Objects/CharacterSpawn/SpawnTrigger"]
script = ExtResource( 13 )

[node name="Erazor" parent="Objects" instance=ExtResource( 9 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -70 )

[node name="InfiniteHall" type="Spatial" parent="Objects"]
script = ExtResource( 15 )
hallRoot = NodePath("HallRoot")
sky = NodePath("../../Visuals/NPSky")
reflection = NodePath("Reflections")
itemBundle = NodePath("ItemBundle")
itemBundleLocations = [ 6, 18, 0 ]
collisionPiece = NodePath("Collision/Collision")
collisionPiece2 = NodePath("Collision/Collision2")

[node name="ItemBundle" parent="Objects/InfiniteHall" instance=ExtResource( 16 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -58 )

[node name="HallRoot" parent="Objects/InfiniteHall" instance=ExtResource( 3 )]

[node name="Hall2" parent="Objects/InfiniteHall/HallRoot" instance=ExtResource( 3 )]
transform = Transform( 0.999848, 0, 0.0174526, 0, 1, 0, -0.0174524, 0, 0.999858, 0, 0, -87 )

[node name="AdvanceTrigger" parent="Objects/InfiniteHall/HallRoot/Hall2" instance=ExtResource( 11 )]
transform = Transform( 1, 0, -1.30385e-08, 0, 1, 0, 1.30385e-08, 0, 1, -0.628286, -1, -36.0057 )

[node name="CollisionShape" type="CollisionShape" parent="Objects/InfiniteHall/HallRoot/Hall2/AdvanceTrigger"]
transform = Transform( 1, 0, -5.58794e-09, 0, 1, 0, 5.58794e-09, 0, 1, 0, 15, 0 )
shape = SubResource( 10 )

[node name="Hall3" parent="Objects/InfiniteHall/HallRoot/Hall2" instance=ExtResource( 3 )]
transform = Transform( 0.999848, 0, 0.0174524, 0, 1, 0, -0.0174524, 0, 0.999848, 0, 0, -87 )

[node name="Hall4" parent="Objects/InfiniteHall/HallRoot/Hall2/Hall3" instance=ExtResource( 3 )]
transform = Transform( 0.999849, 0, 0.0174512, 0, 1, 0, -0.0174515, 0, 0.999829, -0.000183105, 0, -86.9957 )

[node name="Hall5" parent="Objects/InfiniteHall/HallRoot/Hall2/Hall3/Hall4" instance=ExtResource( 3 )]
transform = Transform( 0.999848, 0, 0.0174524, 0, 1, 0, -0.0174524, 0, 0.999848, -4.76837e-06, 0, -87 )

[node name="NPBossLOD" parent="Objects/InfiniteHall/HallRoot/Hall2/Hall3/Hall4/Hall5" instance=ExtResource( 6 )]
transform = Transform( 0.999848, 0, 0.0174524, 0, 1, 0, -0.0174524, 0, 0.999848, -1.51836, 0, -86.9868 )

[node name="NPBossLOD" parent="Objects/InfiniteHall/HallRoot/Hall2/Hall3/Hall4/Hall5/NPBossLOD" instance=ExtResource( 6 )]
transform = Transform( 0.999848, 0, 0.0174524, 0, 1, 0, -0.0174524, 0, 0.999848, 0, 0, -87 )

[node name="NPBossLOD" parent="Objects/InfiniteHall/HallRoot/Hall2/Hall3/Hall4/Hall5/NPBossLOD/NPBossLOD" instance=ExtResource( 6 )]
transform = Transform( 0.999848, 0, 0.0174524, 0, 1, 0, -0.0174524, 0, 0.999848, 0, 0, -87 )

[node name="NPBossLOD" parent="Objects/InfiniteHall/HallRoot/Hall2/Hall3/Hall4/Hall5/NPBossLOD/NPBossLOD/NPBossLOD" instance=ExtResource( 6 )]
transform = Transform( 0.999848, 0, 0.0174524, 0, 1, 0, -0.0174524, 0, 0.999848, 0, 0, -87 )

[node name="NPBossLOD2" parent="Objects/InfiniteHall/HallRoot/Hall2/Hall3/Hall4/Hall5/NPBossLOD/NPBossLOD/NPBossLOD/NPBossLOD" instance=ExtResource( 6 )]
transform = Transform( 0.999848, 0, 0.0174524, 0, 1, 0, -0.0174524, 0, 0.999848, 0, 0, -87 )

[node name="Collision" type="Spatial" parent="Objects/InfiniteHall"]
visible = false

[node name="Collision" type="Spatial" parent="Objects/InfiniteHall/Collision"]

[node name="AdvanceTrigger" parent="Objects/InfiniteHall/Collision/Collision" instance=ExtResource( 11 )]
transform = Transform( 0.999848, 0, 0.0174524, 0, 1, 0, -0.0174524, 0, 0.999848, 0, -1, -97 )

[node name="CollisionShape" type="CollisionShape" parent="Objects/InfiniteHall/Collision/Collision/AdvanceTrigger"]
transform = Transform( 1, 0, -5.58794e-09, 0, 1, 0, 5.58794e-09, 0, 1, 0, 15, 0 )
shape = SubResource( 10 )

[node name="Floor" type="MeshInstance" parent="Objects/InfiniteHall/Collision/Collision"]
mesh = SubResource( 11 )
skeleton = NodePath("")

[node name="StaticBody" type="StaticBody" parent="Objects/InfiniteHall/Collision/Collision/Floor" groups=["floor"]]

[node name="CollisionShape" type="CollisionShape" parent="Objects/InfiniteHall/Collision/Collision/Floor/StaticBody"]
shape = SubResource( 12 )

[node name="Wall" type="MeshInstance" parent="Objects/InfiniteHall/Collision/Collision"]
mesh = SubResource( 13 )
skeleton = NodePath("")

[node name="StaticBody" type="StaticBody" parent="Objects/InfiniteHall/Collision/Collision/Wall" groups=["wall"]]

[node name="CollisionShape" type="CollisionShape" parent="Objects/InfiniteHall/Collision/Collision/Wall/StaticBody"]
shape = SubResource( 14 )

[node name="Collision2" type="Spatial" parent="Objects/InfiniteHall/Collision"]

[node name="AdvanceTrigger" parent="Objects/InfiniteHall/Collision/Collision2" instance=ExtResource( 11 )]
transform = Transform( 0.999848, 0, 0.0174524, 0, 1, 0, -0.0174524, 0, 0.999848, -1, -1, -194 )

[node name="CollisionShape" type="CollisionShape" parent="Objects/InfiniteHall/Collision/Collision2/AdvanceTrigger"]
transform = Transform( 1, 0, -5.58794e-09, 0, 1, 0, 5.58794e-09, 0, 1, 0, 15, 0 )
shape = SubResource( 10 )

[node name="Floor" type="MeshInstance" parent="Objects/InfiniteHall/Collision/Collision2"]
transform = Transform( 0.999847, 0, 0.0174524, 0, 1, 0, -0.0174524, 0, 0.999847, 0, 0, -87 )
mesh = SubResource( 11 )
skeleton = NodePath("")

[node name="StaticBody" type="StaticBody" parent="Objects/InfiniteHall/Collision/Collision2/Floor" groups=["floor"]]

[node name="CollisionShape" type="CollisionShape" parent="Objects/InfiniteHall/Collision/Collision2/Floor/StaticBody"]
shape = SubResource( 12 )

[node name="Wall" type="MeshInstance" parent="Objects/InfiniteHall/Collision/Collision2"]
transform = Transform( 0.999847, 0, 0.0174524, 0, 1, 0, -0.0174524, 0, 0.999847, 0, 0, -87 )
mesh = SubResource( 13 )
skeleton = NodePath("")

[node name="StaticBody" type="StaticBody" parent="Objects/InfiniteHall/Collision/Collision2/Wall" groups=["wall"]]

[node name="CollisionShape" type="CollisionShape" parent="Objects/InfiniteHall/Collision/Collision2/Wall/StaticBody"]
shape = SubResource( 14 )

[node name="Reflections" type="Spatial" parent="Objects/InfiniteHall"]
transform = Transform( 1, 0, 0, 0, -4.37114e-08, 1, 0, -1, -4.37114e-08, 0, 0, 0 )

[node name="Reflection" type="MeshInstance" parent="Objects/InfiniteHall/Reflections"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -9, 2.84217e-14 )
material_override = ExtResource( 8 )
cast_shadow = 0
mesh = SubResource( 2 )
skeleton = NodePath("../..")
script = ExtResource( 7 )
environment = null
resolution = 2048
fit_mode = 0
perturb_scale = 0.7
clip_bias = 0.1
position_offset = Vector2( 0, -44 )
render_sky = true
cull_mask = 3

[node name="Reflection2" type="MeshInstance" parent="Objects/InfiniteHall/Reflections"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 78.991, 0 )
material_override = ExtResource( 8 )
cast_shadow = 0
mesh = SubResource( 2 )
skeleton = NodePath("../..")
script = ExtResource( 7 )
environment = null
resolution = 1024
fit_mode = 0
perturb_scale = 0.7
clip_bias = 0.1
position_offset = Vector2( 0, -44 )
render_sky = true
cull_mask = 3

[node name="PlayerReflection" type="MeshInstance" parent="Objects/InfiniteHall/Reflections"]
material_override = SubResource( 15 )
cast_shadow = 0
mesh = SubResource( 4 )
skeleton = NodePath("../..")
script = ExtResource( 7 )
environment = null
resolution = 2048
fit_mode = 0
perturb_scale = 0.7
clip_bias = 0.1
position_offset = Vector2( 0, 0 )
render_sky = true
cull_mask = 3

[node name="Visuals" type="Spatial" parent="."]

[node name="Moonlight" type="DirectionalLight" parent="Visuals"]
transform = Transform( 2.563e-06, -0.642788, 0.766044, 0, 0.766044, 0.642788, -1, -1.64747e-06, 1.96337e-06, 12.4917, 0, -7.73828 )
light_energy = 1.2
light_specular = 2.0
shadow_enabled = true
shadow_color = Color( 0.517647, 0.517647, 0.517647, 1 )
shadow_bias = 0.5
directional_shadow_blend_splits = true

[node name="NPSky" parent="Visuals" instance=ExtResource( 2 )]
transform = Transform( 1.05654, 0, -2.26577, 0, 2.5, 0, 2.26577, 0, 1.05654, -4500, 0, -1000 )

[node name="WorldEnvironment" type="WorldEnvironment" parent="Visuals"]
environment = ExtResource( 4 )

[node name="Paths" type="Spatial" parent="."]
visible = false

[node name="MainPath" type="Path" parent="Paths"]
curve = ExtResource( 1 )

[node name="BGM" parent="." instance=ExtResource( 5 )]
autoplay = true

[connection signal="DuelCompleted" from="Objects/Erazor" to="Objects/InfiniteHall" method="ResetHallway"]
[connection signal="Activated" from="Objects/InfiniteHall/HallRoot/Hall2/AdvanceTrigger" to="Objects/InfiniteHall" method="AdvanceHall" flags=3]
[connection signal="Activated" from="Objects/InfiniteHall/Collision/Collision/AdvanceTrigger" to="Objects/InfiniteHall" method="AdvanceCollision" flags=3 binds= [ true ]]
[connection signal="Activated" from="Objects/InfiniteHall/Collision/Collision2/AdvanceTrigger" to="Objects/InfiniteHall" method="AdvanceCollision" flags=3 binds= [ false ]]
